{"version":3,"file":"bundle.js","sources":["../src/utils.js","../src/createBtnDom.js","../src/index.js"],"sourcesContent":["export const setDomDisplay = (dom, value) => {\n  dom.style.display = value\n}\n\nexport const setuuid = () => {\n  return new Date().getTime()\n}\n\nexport const setTextSelected = (className, text, id, styles) => {\n  const span = document.createElement('span')\n  span.className = className\n  span.id = id\n  span.innerHTML = text\n  if (styles) {\n    Object.keys(styles).forEach(key => {\n      span.style[key] = styles[key]\n    })\n  }\n  return span\n}\n\nexport const getUserAgent = () => {\n  const u = navigator.userAgent\n  const isAndroid = u.indexOf('Android') > -1 || u.indexOf('Adr') > -1\n  const isiOS = !!u.match(/\\(i[^;]+;( U;)? CPU.+Mac OS X/)\n  const eventName = {\n    mousedown: isAndroid || isiOS ? 'touchstart' : 'mousedown',\n    mouseup: isAndroid || isiOS ? 'touchend' : 'mouseup',\n    mousemove: isAndroid || isiOS ? 'touchmove' : 'mousemove',\n  }\n  return {\n    isAndroid,\n    isiOS,\n    eventName\n  }\n}\n\nexport const setMarkClassName = (dom, index = 1) => {\n  if (dom.childNodes) {\n    for (let i = 0; i < dom.childNodes.length; i++) {\n      const childNode = dom.childNodes[i]\n      if (childNode.nodeType === 1) {\n        const ingoreNodes = ['BR', 'HR', 'SCRIPT', 'BUTTON']\n        if (!ingoreNodes.includes(childNode.nodeName)) {\n          childNode.className = childNode.className ? childNode.className + ` _WM-${index}-${i}` : `_WM-${index}-${i}`\n        }\n        if (childNode.childNodes.length > 0) {\n          setMarkClassName(childNode, index + 1 + `-${i}`)\n        }\n      }\n    }\n  }\n}\n\nexport const mergeTextNode = dom => {\n  const parentNode = dom.parentNode\n  if(!parentNode) return\n  const text = dom.innerText\n  const replaceTextNode = document.createTextNode(text)\n  parentNode.replaceChild(replaceTextNode, dom)\n  const preDom = replaceTextNode.previousSibling\n  const nextDom = replaceTextNode.nextSibling\n\n  // 合并文本节点\n  if (preDom && preDom.nodeType === 3) {\n    preDom.textContent = preDom.textContent + text\n    parentNode.removeChild(replaceTextNode)\n    if (nextDom && nextDom.nodeType === 3) {\n      preDom.textContent = preDom.textContent + nextDom.textContent\n      parentNode.removeChild(nextDom)\n    }\n  } else {\n    if (nextDom && nextDom.nodeType === 3) {\n      replaceTextNode.textContent = replaceTextNode.textContent + nextDom.textContent\n      parentNode.removeChild(nextDom)\n    }\n  }\n}","import {getUserAgent} from './utils'\n\nconst createBtnDom = (textMarker, styles) => {\n    const defaultStyles = {\n      position: 'absolute',\n      textAlign: 'center',\n      width: '98%',\n      left: '1%',\n      height: '35px',\n      lineHeight: '35px',\n      backgroundColor: 'black',\n      borderRadius: 3,\n      display: 'none',\n      color: '#fff',\n      transition: 'all .3s',\n      ...styles\n    }\n    const btnBox = document.createElement('div')\n\n    btnBox.id = 'webMarkerBtnBox'\n    Object.keys(defaultStyles).forEach(key => {\n      btnBox.style[key] = defaultStyles[key]\n    })\n\n    btnBox.innerHTML = `\n      <div style=\"flex: 1\" id=\"webMarker_btn_mark\">标记</div>\n      <div style=\"flex: 1\" id=\"webMarker_btn_delete\">删除标记</div>\n      <div style=\"flex: 1\" id=\"webMarker_btn_cancel\">取消</div>\n      <div id=\"webMarker_arrow\"></div>\n    `\n\n\n    document.body.appendChild(btnBox)\n\n\n    const arrow = document.getElementById('webMarker_arrow')\n    arrow.style.position = 'absolute'\n    arrow.style.width = '10px'\n    arrow.style.height = '10px'\n    arrow.style.backgroundColor = defaultStyles.backgroundColor\n    arrow.style.left = '50%'\n    arrow.style.marginLeft = '-5px'\n    arrow.style.bottom = '-5px'\n    arrow.style.transform = 'rotate(45deg)'\n    arrow.style.transition = 'all .3s'\n\n    textMarker.arrow = arrow\n    textMarker.btn_Box = document.getElementById('webMarkerBtnBox')\n    textMarker.btn_mark = document.getElementById('webMarker_btn_mark')\n    textMarker.btn_cancel = document.getElementById('webMarker_btn_cancel')\n    textMarker.btn_delete = document.getElementById('webMarker_btn_delete')\n\n    textMarker.btn_mark.addEventListener(getUserAgent().eventName.mousedown, textMarker.mark.bind(textMarker))\n    textMarker.btn_cancel.addEventListener('click', textMarker.hide.bind(textMarker))\n    textMarker.btn_delete.addEventListener('click', textMarker.del.bind(textMarker))\n  \n  }\n\n  export default createBtnDom","import {\n  setDomDisplay,\n  setuuid,\n  setTextSelected,\n  getUserAgent,\n  setMarkClassName,\n  mergeTextNode,\n} from './utils'\nimport createBtnDom from './createBtnDom.js'\n\n\n/**\n * @class Marker\n * @param id: id, setuuid() 生成, 一个简单的按当前时间生成的字符串, 不需要太专业\n * @param parentClassName: 父节点className, 对应 selectedMarkers 中的 key,\n * @param childIndex: 在父节点中的索引\n * @param start: 标记开始位置\n * @param end: 标记结束位置\n */\nclass Marker {\n  constructor(id, parentClassName, childIndex, start, end) {\n    this.id = id\n    this.childIndex = childIndex\n    this.start = start\n    this.end = end\n    if (parentClassName) {\n      this.parentClassName = parentClassName\n    }\n  }\n}\n\n/**\n * @class WebTextMarker\n * @param options.defaultMarkers: 初始标记数据\n * @param options.markedStyles: 标记文本样式\n * @param options.btnStyles: 操作框样式\n * @param options.onSave: 标记后回调, 必填\n */\n\nclass WebTextMarker {\n  constructor(options) {\n\n    if (!options || !options.onSave) {\n      throw new Error('options中的 onSave 选项为必填')\n    }\n\n    if (typeof options.onSave !== 'function') {\n      throw new Error('onSave 必须为一个函数')\n    }\n\n    if (options.markedStyles && Object.prototype.toString.call(options.markedStyles) === '[object Object]') {\n      throw new Error('defaultMarkers 必须为一个对象')\n    }\n\n    if (options.btnStyles && Object.prototype.toString.call(options.btnStyles) === '[object Object]') {\n      throw new Error('btnStyles 必须为一个对象')\n    }\n\n    this.MAKRED_CLASSNAME = 'web_marker'\n    this.TEMP_MARKED_CLASSNAME = 'temp_marker'\n\n    // 标记样式\n    this.markedStyles = {\n      color: '#fff',\n      backgroundColor: 'cadetblue',\n      ...options.markedStyles\n    }\n\n    // 回调\n    this.onSave = options.onSave\n\n    // 所有标记文本, 格式为: {parentClassName: [Marker, Marker, ...]}, 最后转换成json字符串保存到数据库\n    this.selectedMarkers = {}\n\n    // 选中文本对象, 从 window.getSelection() 中拿\n    this.selectedText = {}\n\n    // 临时标记节点\n    this.tempMarkDom = null\n\n    // 临时保存标记信息, 鼠标抬起时设置, 解决点击\"标记\"按钮时 window.getSelection 影响 this.selectedText 的问题\n    this.tempMarkerInfo = {}\n\n    // 要删除的标记 id\n    this.deleteId = ''\n\n    // 是否已标记\n    this.isMarked = false\n\n    // 获取浏览器环境\n    this.userAgent = getUserAgent()\n\n    // 给每个节点加上特殊标识, 方便后面操作\n    setMarkClassName(document.body)\n\n    // 创建按钮节点\n    createBtnDom(this, options.btnStyles)\n\n    // 当默认数据时, 设置标记状态, defaultMarkers 格式 this.selectedMarkers \n    if (options.defaultMarkers && Object.keys(options.defaultMarkers).length > 0) {\n      this.selectedMarkers = options.defaultMarkers\n      this.setDefaultMarkers()\n    }\n\n\n\n    // 监听事件\n    document.addEventListener('selectionchange', this.handleSelectionChange.bind(this))\n    document.addEventListener(this.userAgent.eventName.mousedown, this.handleMouseDown.bind(this))\n    document.addEventListener(this.userAgent.eventName.mouseup, this.handleMouseUp.bind(this))\n  }\n\n  // 选中文本事件\n  handleSelectionChange() {\n    if (window.getSelection()) {\n      this.selectedText = window.getSelection()\n      if(this.tempMarkDom && this.tempMarkDom.className === 'web_marker') return\n      if (this.selectedText.toString().length === 0 || !this.selectedText.getRangeAt) {\n        this.hide()\n      }\n    } else {\n      return\n    }\n  }\n\n  // 鼠标按下\n  handleMouseDown(e) {\n    const target = e.target\n    // 当选中的文本已经标记时的处理, 隐藏 \"标记\" 按钮, 显示 \"删除\" 按钮\n    if (target.className === this.MAKRED_CLASSNAME) {\n      this.pageY = e.pageY\n      setDomDisplay(this.btn_mark, 'none')\n      setDomDisplay(this.btn_delete, 'block')\n      this.deleteId = e.target.id\n      this.isMarked = true\n      this.tempMarkDom = target\n      this.show()\n      return\n    }\n    this.isMarked = false\n  }\n\n  // 鼠标抬起事件\n  handleMouseUp(e) {\n    if (this.isMarked) {\n      return\n    }\n\n    if (this.selectedText.toString().length === 0 || !this.selectedText.getRangeAt) {\n      return\n    }\n\n    setTimeout(() => {\n      if (this.selectedText.toString().length === 0 || !this.selectedText.getRangeAt) {\n        this.hide()\n      }\n    }, 0);\n\n    const {\n      commonAncestorContainer\n    } = this.selectedText.getRangeAt(0)\n\n    if (commonAncestorContainer.nodeType !== 3 || commonAncestorContainer.parentNode.className === this.MAKRED_CLASSNAME) {\n      return\n    }\n    \n    // 遇到以下节点时不处理, 可按需要添加\n    const disabledElement = ['BUTTON', 'H1', 'H2', 'IMG']\n    if (disabledElement.includes(commonAncestorContainer.parentNode.nodeName)) {\n      return\n    }\n\n    setDomDisplay(this.btn_mark, 'block')\n    setDomDisplay(this.btn_delete, 'none')\n\n    const {\n      anchorOffset,\n      focusOffset\n    } = this.selectedText\n    this.pageY = e.pageY\n\n    const startIndex = Math.min(anchorOffset, focusOffset)\n    const endIndex = Math.max(anchorOffset, focusOffset)\n    const className = commonAncestorContainer.parentNode.className.split(' ')\n    let parentClassName = className[className.length - 1]\n    this.tempMarkerInfo = new Marker(setuuid(), parentClassName, 0, startIndex, endIndex)\n\n\n    const text = this.selectedText.toString()\n    const rang = this.selectedText.getRangeAt(0)\n    const span = setTextSelected(this.TEMP_MARKED_CLASSNAME, text, this.tempMarkerInfo.id)\n    rang.surroundContents(span);\n\n    this.tempMarkDom =  document.getElementsByClassName(this.TEMP_MARKED_CLASSNAME)[0]\n    this.show()\n  }\n\n  hide() {\n    setDomDisplay(this.btn_Box, 'none')\n    if(!this.tempMarkDom) return\n    mergeTextNode(this.tempMarkDom)\n  }\n\n  show() {\n    setDomDisplay(this.btn_Box, 'flex')\n    const position = this.tempMarkDom.getBoundingClientRect()\n    this.btn_Box.style.top = position.top + window.scrollY - 50 + 'px'\n    this.arrow.style.left = position.left + this.tempMarkDom.offsetWidth / 2 - 5 + 'px'\n  }\n\n  mark(e) {\n    e.preventDefault()\n    e.stopPropagation()\n    this.tempMarkDom.className = this.MAKRED_CLASSNAME\n    Object.keys(this.markedStyles).forEach(key => {\n      this.tempMarkDom.style[key] = this.markedStyles[key]\n    })\n    const {parentClassName} = this.tempMarkerInfo\n    if (!this.selectedMarkers[parentClassName]) {\n      this.selectedMarkers[parentClassName] = [this.tempMarkerInfo]\n    } else {\n      this.selectedMarkers[parentClassName].push(this.tempMarkerInfo)\n    }\n    const newMarkerArr = this.resetMarker(parentClassName)\n    this.selectedMarkers[parentClassName] = newMarkerArr\n    this.selectedText.removeAllRanges()\n    this.tempMarkDom = null\n    this.save()\n\n  }\n\n  resetMarker(parentClassName) {\n    const dom = document.getElementsByClassName(parentClassName)[0]\n    const newMarkerArr = []\n    let preNodeLength = 0\n    for (let i = 0; i < dom.childNodes.length; i++) {\n      const node = dom.childNodes[i]\n      if (node.nodeName === '#text') {\n        preNodeLength = node.textContent.length\n      }\n      // childIndex 为什么是 i - 1 ? 根据当前已经标记节点索引, 在后面反序列的时候才能找到正确位置\n      // 比如当前节点内容为\"xxx <标记节点>ooo</标记节点>\", i 就是 1, 反序列的时候其实他是处于 0 的位置 \n      const childIndex = i - 1  \n      this.selectedMarkers[parentClassName].forEach(marker => {\n        if (dom.childNodes[i].id == marker.id) {\n          newMarkerArr.push(new Marker(marker.id, '', childIndex, preNodeLength, preNodeLength + node.textContent.length))\n        }\n      })\n    }\n    return newMarkerArr\n  }\n\n  save() {\n    const markersJson = JSON.stringify(this.selectedMarkers)\n    const userAgent = getUserAgent()\n    this.hide()\n    if (userAgent.isAndroid) {\n      // window.jsObject...\n    }\n\n    if (userAgent.isiOS) {\n      // window.webkit.jsObject.callBack.postMessage(this.selectedMarkers)\n    }\n\n    if (this.onSave) {\n      this.onSave(markersJson)\n    }\n\n    console.log(this.selectedMarkers)\n  }\n\n  del() {\n    this.tempMarkDom = null\n    const dom = document.getElementById(this.deleteId)\n    const className = dom.parentNode.className.split(' ')\n    const parentClassName = className[className.length - 1]\n    mergeTextNode(dom)\n    const newMarkerArr = this.resetMarker(parentClassName)\n    this.selectedMarkers[parentClassName] = newMarkerArr\n    this.save()\n  }\n\n  setDefaultMarkers() {\n    const defaultMarkers = this.selectedMarkers\n    Object.keys(defaultMarkers).forEach(className => {\n      const dom = document.getElementsByClassName(className)[0]\n      defaultMarkers[className].forEach(marker => {\n        const currentNode = dom.childNodes[marker.childIndex]\n        currentNode.splitText(marker.start);\n        const nextNode = currentNode.nextSibling;\n        nextNode.splitText(marker.end - marker.start)\n        const markedNode = setTextSelected(this.MAKRED_CLASSNAME, nextNode.textContent, marker.id, this.markedStyles)\n        dom.replaceChild(markedNode, nextNode)\n      })\n    })\n  }\n}\n\nwindow.WebTextMarker = WebTextMarker"],"names":[],"mappings":";;;;;EAAO,MAAM,aAAa,GAAG,CAAC,GAAG,EAAE,KAAK,KAAK;EAC7C,EAAE,GAAG,CAAC,KAAK,CAAC,OAAO,GAAG,MAAK;EAC3B,EAAC;AACD;EACO,MAAM,OAAO,GAAG,MAAM;EAC7B,EAAE,OAAO,IAAI,IAAI,EAAE,CAAC,OAAO,EAAE;EAC7B,EAAC;AACD;EACO,MAAM,eAAe,GAAG,CAAC,SAAS,EAAE,IAAI,EAAE,EAAE,EAAE,MAAM,KAAK;EAChE,EAAE,MAAM,IAAI,GAAG,QAAQ,CAAC,aAAa,CAAC,MAAM,EAAC;EAC7C,EAAE,IAAI,CAAC,SAAS,GAAG,UAAS;EAC5B,EAAE,IAAI,CAAC,EAAE,GAAG,GAAE;EACd,EAAE,IAAI,CAAC,SAAS,GAAG,KAAI;EACvB,EAAE,IAAI,MAAM,EAAE;EACd,IAAI,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC,GAAG,IAAI;EACvC,MAAM,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,GAAG,MAAM,CAAC,GAAG,EAAC;EACnC,KAAK,EAAC;EACN,GAAG;EACH,EAAE,OAAO,IAAI;EACb,EAAC;AACD;EACO,MAAM,YAAY,GAAG,MAAM;EAClC,EAAE,MAAM,CAAC,GAAG,SAAS,CAAC,UAAS;EAC/B,EAAE,MAAM,SAAS,GAAG,CAAC,CAAC,OAAO,CAAC,SAAS,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,CAAC,OAAO,CAAC,KAAK,CAAC,GAAG,CAAC,EAAC;EACtE,EAAE,MAAM,KAAK,GAAG,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,+BAA+B,EAAC;EAC1D,EAAE,MAAM,SAAS,GAAG;EACpB,IAAI,SAAS,EAAE,SAAS,IAAI,KAAK,GAAG,YAAY,GAAG,WAAW;EAC9D,IAAI,OAAO,EAAE,SAAS,IAAI,KAAK,GAAG,UAAU,GAAG,SAAS;EACxD,IAAI,SAAS,EAAE,SAAS,IAAI,KAAK,GAAG,WAAW,GAAG,WAAW;EAC7D,IAAG;EACH,EAAE,OAAO;EACT,IAAI,SAAS;EACb,IAAI,KAAK;EACT,IAAI,SAAS;EACb,GAAG;EACH,EAAC;AACD;EACO,MAAM,gBAAgB,GAAG,CAAC,GAAG,EAAE,KAAK,GAAG,CAAC,KAAK;EACpD,EAAE,IAAI,GAAG,CAAC,UAAU,EAAE;EACtB,IAAI,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,GAAG,CAAC,UAAU,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;EACpD,MAAM,MAAM,SAAS,GAAG,GAAG,CAAC,UAAU,CAAC,CAAC,EAAC;EACzC,MAAM,IAAI,SAAS,CAAC,QAAQ,KAAK,CAAC,EAAE;EACpC,QAAQ,MAAM,WAAW,GAAG,CAAC,IAAI,EAAE,IAAI,EAAE,QAAQ,EAAE,QAAQ,EAAC;EAC5D,QAAQ,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,SAAS,CAAC,QAAQ,CAAC,EAAE;EACvD,UAAU,SAAS,CAAC,SAAS,GAAG,SAAS,CAAC,SAAS,GAAG,SAAS,CAAC,SAAS,GAAG,CAAC,KAAK,EAAE,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,EAAC;EACtH,SAAS;EACT,QAAQ,IAAI,SAAS,CAAC,UAAU,CAAC,MAAM,GAAG,CAAC,EAAE;EAC7C,UAAU,gBAAgB,CAAC,SAAS,EAAE,KAAK,GAAG,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAC;EAC1D,SAAS;EACT,OAAO;EACP,KAAK;EACL,GAAG;EACH,EAAC;AACD;EACO,MAAM,aAAa,GAAG,GAAG,IAAI;EACpC,EAAE,MAAM,UAAU,GAAG,GAAG,CAAC,WAAU;EACnC,EAAE,GAAG,CAAC,UAAU,EAAE,MAAM;EACxB,EAAE,MAAM,IAAI,GAAG,GAAG,CAAC,UAAS;EAC5B,EAAE,MAAM,eAAe,GAAG,QAAQ,CAAC,cAAc,CAAC,IAAI,EAAC;EACvD,EAAE,UAAU,CAAC,YAAY,CAAC,eAAe,EAAE,GAAG,EAAC;EAC/C,EAAE,MAAM,MAAM,GAAG,eAAe,CAAC,gBAAe;EAChD,EAAE,MAAM,OAAO,GAAG,eAAe,CAAC,YAAW;AAC7C;EACA;EACA,EAAE,IAAI,MAAM,IAAI,MAAM,CAAC,QAAQ,KAAK,CAAC,EAAE;EACvC,IAAI,MAAM,CAAC,WAAW,GAAG,MAAM,CAAC,WAAW,GAAG,KAAI;EAClD,IAAI,UAAU,CAAC,WAAW,CAAC,eAAe,EAAC;EAC3C,IAAI,IAAI,OAAO,IAAI,OAAO,CAAC,QAAQ,KAAK,CAAC,EAAE;EAC3C,MAAM,MAAM,CAAC,WAAW,GAAG,MAAM,CAAC,WAAW,GAAG,OAAO,CAAC,YAAW;EACnE,MAAM,UAAU,CAAC,WAAW,CAAC,OAAO,EAAC;EACrC,KAAK;EACL,GAAG,MAAM;EACT,IAAI,IAAI,OAAO,IAAI,OAAO,CAAC,QAAQ,KAAK,CAAC,EAAE;EAC3C,MAAM,eAAe,CAAC,WAAW,GAAG,eAAe,CAAC,WAAW,GAAG,OAAO,CAAC,YAAW;EACrF,MAAM,UAAU,CAAC,WAAW,CAAC,OAAO,EAAC;EACrC,KAAK;EACL,GAAG;EACH;;EC3EA,MAAM,YAAY,GAAG,CAAC,UAAU,EAAE,MAAM,KAAK;EAC7C,IAAI,MAAM,aAAa,GAAG;EAC1B,MAAM,QAAQ,EAAE,UAAU;EAC1B,MAAM,SAAS,EAAE,QAAQ;EACzB,MAAM,KAAK,EAAE,KAAK;EAClB,MAAM,IAAI,EAAE,IAAI;EAChB,MAAM,MAAM,EAAE,MAAM;EACpB,MAAM,UAAU,EAAE,MAAM;EACxB,MAAM,eAAe,EAAE,OAAO;EAC9B,MAAM,YAAY,EAAE,CAAC;EACrB,MAAM,OAAO,EAAE,MAAM;EACrB,MAAM,KAAK,EAAE,MAAM;EACnB,MAAM,UAAU,EAAE,SAAS;EAC3B,MAAM,GAAG,MAAM;EACf,MAAK;EACL,IAAI,MAAM,MAAM,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,EAAC;AAChD;EACA,IAAI,MAAM,CAAC,EAAE,GAAG,kBAAiB;EACjC,IAAI,MAAM,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC,OAAO,CAAC,GAAG,IAAI;EAC9C,MAAM,MAAM,CAAC,KAAK,CAAC,GAAG,CAAC,GAAG,aAAa,CAAC,GAAG,EAAC;EAC5C,KAAK,EAAC;AACN;EACA,IAAI,MAAM,CAAC,SAAS,GAAG,CAAC;AACxB;AACA;AACA;AACA;AACA,IAAI,EAAC;AACL;AACA;EACA,IAAI,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,MAAM,EAAC;AACrC;AACA;EACA,IAAI,MAAM,KAAK,GAAG,QAAQ,CAAC,cAAc,CAAC,iBAAiB,EAAC;EAC5D,IAAI,KAAK,CAAC,KAAK,CAAC,QAAQ,GAAG,WAAU;EACrC,IAAI,KAAK,CAAC,KAAK,CAAC,KAAK,GAAG,OAAM;EAC9B,IAAI,KAAK,CAAC,KAAK,CAAC,MAAM,GAAG,OAAM;EAC/B,IAAI,KAAK,CAAC,KAAK,CAAC,eAAe,GAAG,aAAa,CAAC,gBAAe;EAC/D,IAAI,KAAK,CAAC,KAAK,CAAC,IAAI,GAAG,MAAK;EAC5B,IAAI,KAAK,CAAC,KAAK,CAAC,UAAU,GAAG,OAAM;EACnC,IAAI,KAAK,CAAC,KAAK,CAAC,MAAM,GAAG,OAAM;EAC/B,IAAI,KAAK,CAAC,KAAK,CAAC,SAAS,GAAG,gBAAe;EAC3C,IAAI,KAAK,CAAC,KAAK,CAAC,UAAU,GAAG,UAAS;AACtC;EACA,IAAI,UAAU,CAAC,KAAK,GAAG,MAAK;EAC5B,IAAI,UAAU,CAAC,OAAO,GAAG,QAAQ,CAAC,cAAc,CAAC,iBAAiB,EAAC;EACnE,IAAI,UAAU,CAAC,QAAQ,GAAG,QAAQ,CAAC,cAAc,CAAC,oBAAoB,EAAC;EACvE,IAAI,UAAU,CAAC,UAAU,GAAG,QAAQ,CAAC,cAAc,CAAC,sBAAsB,EAAC;EAC3E,IAAI,UAAU,CAAC,UAAU,GAAG,QAAQ,CAAC,cAAc,CAAC,sBAAsB,EAAC;AAC3E;EACA,IAAI,UAAU,CAAC,QAAQ,CAAC,gBAAgB,CAAC,YAAY,EAAE,CAAC,SAAS,CAAC,SAAS,EAAE,UAAU,CAAC,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,EAAC;EAC9G,IAAI,UAAU,CAAC,UAAU,CAAC,gBAAgB,CAAC,OAAO,EAAE,UAAU,CAAC,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,EAAC;EACrF,IAAI,UAAU,CAAC,UAAU,CAAC,gBAAgB,CAAC,OAAO,EAAE,UAAU,CAAC,GAAG,CAAC,IAAI,CAAC,UAAU,CAAC,EAAC;EACpF;EACA;;EC7CA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA,MAAM,MAAM,CAAC;EACb,EAAE,WAAW,CAAC,EAAE,EAAE,eAAe,EAAE,UAAU,EAAE,KAAK,EAAE,GAAG,EAAE;EAC3D,IAAI,IAAI,CAAC,EAAE,GAAG,GAAE;EAChB,IAAI,IAAI,CAAC,UAAU,GAAG,WAAU;EAChC,IAAI,IAAI,CAAC,KAAK,GAAG,MAAK;EACtB,IAAI,IAAI,CAAC,GAAG,GAAG,IAAG;EAClB,IAAI,IAAI,eAAe,EAAE;EACzB,MAAM,IAAI,CAAC,eAAe,GAAG,gBAAe;EAC5C,KAAK;EACL,GAAG;EACH,CAAC;AACD;EACA;EACA;EACA;EACA;EACA;EACA;EACA;AACA;EACA,MAAM,aAAa,CAAC;EACpB,EAAE,WAAW,CAAC,OAAO,EAAE;AACvB;EACA,IAAI,IAAI,CAAC,OAAO,IAAI,CAAC,OAAO,CAAC,MAAM,EAAE;EACrC,MAAM,MAAM,IAAI,KAAK,CAAC,wBAAwB,CAAC;EAC/C,KAAK;AACL;EACA,IAAI,IAAI,OAAO,OAAO,CAAC,MAAM,KAAK,UAAU,EAAE;EAC9C,MAAM,MAAM,IAAI,KAAK,CAAC,gBAAgB,CAAC;EACvC,KAAK;AACL;EACA,IAAI,IAAI,OAAO,CAAC,YAAY,IAAI,MAAM,CAAC,SAAS,CAAC,QAAQ,CAAC,IAAI,CAAC,OAAO,CAAC,YAAY,CAAC,KAAK,iBAAiB,EAAE;EAC5G,MAAM,MAAM,IAAI,KAAK,CAAC,wBAAwB,CAAC;EAC/C,KAAK;AACL;EACA,IAAI,IAAI,OAAO,CAAC,SAAS,IAAI,MAAM,CAAC,SAAS,CAAC,QAAQ,CAAC,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,KAAK,iBAAiB,EAAE;EACtG,MAAM,MAAM,IAAI,KAAK,CAAC,mBAAmB,CAAC;EAC1C,KAAK;AACL;EACA,IAAI,IAAI,CAAC,gBAAgB,GAAG,aAAY;EACxC,IAAI,IAAI,CAAC,qBAAqB,GAAG,cAAa;AAC9C;EACA;EACA,IAAI,IAAI,CAAC,YAAY,GAAG;EACxB,MAAM,KAAK,EAAE,MAAM;EACnB,MAAM,eAAe,EAAE,WAAW;EAClC,MAAM,GAAG,OAAO,CAAC,YAAY;EAC7B,MAAK;AACL;EACA;EACA,IAAI,IAAI,CAAC,MAAM,GAAG,OAAO,CAAC,OAAM;AAChC;EACA;EACA,IAAI,IAAI,CAAC,eAAe,GAAG,GAAE;AAC7B;EACA;EACA,IAAI,IAAI,CAAC,YAAY,GAAG,GAAE;AAC1B;EACA;EACA,IAAI,IAAI,CAAC,WAAW,GAAG,KAAI;AAC3B;EACA;EACA,IAAI,IAAI,CAAC,cAAc,GAAG,GAAE;AAC5B;EACA;EACA,IAAI,IAAI,CAAC,QAAQ,GAAG,GAAE;AACtB;EACA;EACA,IAAI,IAAI,CAAC,QAAQ,GAAG,MAAK;AACzB;EACA;EACA,IAAI,IAAI,CAAC,SAAS,GAAG,YAAY,GAAE;AACnC;EACA;EACA,IAAI,gBAAgB,CAAC,QAAQ,CAAC,IAAI,EAAC;AACnC;EACA;EACA,IAAI,YAAY,CAAC,IAAI,EAAE,OAAO,CAAC,SAAS,EAAC;AACzC;EACA;EACA,IAAI,IAAI,OAAO,CAAC,cAAc,IAAI,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,cAAc,CAAC,CAAC,MAAM,GAAG,CAAC,EAAE;EAClF,MAAM,IAAI,CAAC,eAAe,GAAG,OAAO,CAAC,eAAc;EACnD,MAAM,IAAI,CAAC,iBAAiB,GAAE;EAC9B,KAAK;AACL;AACA;AACA;EACA;EACA,IAAI,QAAQ,CAAC,gBAAgB,CAAC,iBAAiB,EAAE,IAAI,CAAC,qBAAqB,CAAC,IAAI,CAAC,IAAI,CAAC,EAAC;EACvF,IAAI,QAAQ,CAAC,gBAAgB,CAAC,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,SAAS,EAAE,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,IAAI,CAAC,EAAC;EAClG,IAAI,QAAQ,CAAC,gBAAgB,CAAC,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,OAAO,EAAE,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC,EAAC;EAC9F,GAAG;AACH;EACA;EACA,EAAE,qBAAqB,GAAG;EAC1B,IAAI,IAAI,MAAM,CAAC,YAAY,EAAE,EAAE;EAC/B,MAAM,IAAI,CAAC,YAAY,GAAG,MAAM,CAAC,YAAY,GAAE;EAC/C,MAAM,GAAG,IAAI,CAAC,WAAW,IAAI,IAAI,CAAC,WAAW,CAAC,SAAS,KAAK,YAAY,EAAE,MAAM;EAChF,MAAM,IAAI,IAAI,CAAC,YAAY,CAAC,QAAQ,EAAE,CAAC,MAAM,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,UAAU,EAAE;EACtF,QAAQ,IAAI,CAAC,IAAI,GAAE;EACnB,OAAO;EACP,KAAK,MAAM;EACX,MAAM,MAAM;EACZ,KAAK;EACL,GAAG;AACH;EACA;EACA,EAAE,eAAe,CAAC,CAAC,EAAE;EACrB,IAAI,MAAM,MAAM,GAAG,CAAC,CAAC,OAAM;EAC3B;EACA,IAAI,IAAI,MAAM,CAAC,SAAS,KAAK,IAAI,CAAC,gBAAgB,EAAE;EACpD,MAAM,IAAI,CAAC,KAAK,GAAG,CAAC,CAAC,MAAK;EAC1B,MAAM,aAAa,CAAC,IAAI,CAAC,QAAQ,EAAE,MAAM,EAAC;EAC1C,MAAM,aAAa,CAAC,IAAI,CAAC,UAAU,EAAE,OAAO,EAAC;EAC7C,MAAM,IAAI,CAAC,QAAQ,GAAG,CAAC,CAAC,MAAM,CAAC,GAAE;EACjC,MAAM,IAAI,CAAC,QAAQ,GAAG,KAAI;EAC1B,MAAM,IAAI,CAAC,WAAW,GAAG,OAAM;EAC/B,MAAM,IAAI,CAAC,IAAI,GAAE;EACjB,MAAM,MAAM;EACZ,KAAK;EACL,IAAI,IAAI,CAAC,QAAQ,GAAG,MAAK;EACzB,GAAG;AACH;EACA;EACA,EAAE,aAAa,CAAC,CAAC,EAAE;EACnB,IAAI,IAAI,IAAI,CAAC,QAAQ,EAAE;EACvB,MAAM,MAAM;EACZ,KAAK;AACL;EACA,IAAI,IAAI,IAAI,CAAC,YAAY,CAAC,QAAQ,EAAE,CAAC,MAAM,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,UAAU,EAAE;EACpF,MAAM,MAAM;EACZ,KAAK;AACL;EACA,IAAI,UAAU,CAAC,MAAM;EACrB,MAAM,IAAI,IAAI,CAAC,YAAY,CAAC,QAAQ,EAAE,CAAC,MAAM,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,UAAU,EAAE;EACtF,QAAQ,IAAI,CAAC,IAAI,GAAE;EACnB,OAAO;EACP,KAAK,EAAE,CAAC,CAAC,CAAC;AACV;EACA,IAAI,MAAM;EACV,MAAM,uBAAuB;EAC7B,KAAK,GAAG,IAAI,CAAC,YAAY,CAAC,UAAU,CAAC,CAAC,EAAC;AACvC;EACA,IAAI,IAAI,uBAAuB,CAAC,QAAQ,KAAK,CAAC,IAAI,uBAAuB,CAAC,UAAU,CAAC,SAAS,KAAK,IAAI,CAAC,gBAAgB,EAAE;EAC1H,MAAM,MAAM;EACZ,KAAK;EACL;EACA;EACA,IAAI,MAAM,eAAe,GAAG,CAAC,QAAQ,EAAE,IAAI,EAAE,IAAI,EAAE,KAAK,EAAC;EACzD,IAAI,IAAI,eAAe,CAAC,QAAQ,CAAC,uBAAuB,CAAC,UAAU,CAAC,QAAQ,CAAC,EAAE;EAC/E,MAAM,MAAM;EACZ,KAAK;AACL;EACA,IAAI,aAAa,CAAC,IAAI,CAAC,QAAQ,EAAE,OAAO,EAAC;EACzC,IAAI,aAAa,CAAC,IAAI,CAAC,UAAU,EAAE,MAAM,EAAC;AAC1C;EACA,IAAI,MAAM;EACV,MAAM,YAAY;EAClB,MAAM,WAAW;EACjB,KAAK,GAAG,IAAI,CAAC,aAAY;EACzB,IAAI,IAAI,CAAC,KAAK,GAAG,CAAC,CAAC,MAAK;AACxB;EACA,IAAI,MAAM,UAAU,GAAG,IAAI,CAAC,GAAG,CAAC,YAAY,EAAE,WAAW,EAAC;EAC1D,IAAI,MAAM,QAAQ,GAAG,IAAI,CAAC,GAAG,CAAC,YAAY,EAAE,WAAW,EAAC;EACxD,IAAI,MAAM,SAAS,GAAG,uBAAuB,CAAC,UAAU,CAAC,SAAS,CAAC,KAAK,CAAC,GAAG,EAAC;EAC7E,IAAI,IAAI,eAAe,GAAG,SAAS,CAAC,SAAS,CAAC,MAAM,GAAG,CAAC,EAAC;EACzD,IAAI,IAAI,CAAC,cAAc,GAAG,IAAI,MAAM,CAAC,OAAO,EAAE,EAAE,eAAe,EAAE,CAAC,EAAE,UAAU,EAAE,QAAQ,EAAC;AACzF;AACA;EACA,IAAI,MAAM,IAAI,GAAG,IAAI,CAAC,YAAY,CAAC,QAAQ,GAAE;EAC7C,IAAI,MAAM,IAAI,GAAG,IAAI,CAAC,YAAY,CAAC,UAAU,CAAC,CAAC,EAAC;EAChD,IAAI,MAAM,IAAI,GAAG,eAAe,CAAC,IAAI,CAAC,qBAAqB,EAAE,IAAI,EAAE,IAAI,CAAC,cAAc,CAAC,EAAE,EAAC;EAC1F,IAAI,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,CAAC;AAChC;EACA,IAAI,IAAI,CAAC,WAAW,IAAI,QAAQ,CAAC,sBAAsB,CAAC,IAAI,CAAC,qBAAqB,CAAC,CAAC,CAAC,EAAC;EACtF,IAAI,IAAI,CAAC,IAAI,GAAE;EACf,GAAG;AACH;EACA,EAAE,IAAI,GAAG;EACT,IAAI,aAAa,CAAC,IAAI,CAAC,OAAO,EAAE,MAAM,EAAC;EACvC,IAAI,GAAG,CAAC,IAAI,CAAC,WAAW,EAAE,MAAM;EAChC,IAAI,aAAa,CAAC,IAAI,CAAC,WAAW,EAAC;EACnC,GAAG;AACH;EACA,EAAE,IAAI,GAAG;EACT,IAAI,aAAa,CAAC,IAAI,CAAC,OAAO,EAAE,MAAM,EAAC;EACvC,IAAI,MAAM,QAAQ,GAAG,IAAI,CAAC,WAAW,CAAC,qBAAqB,GAAE;EAC7D,IAAI,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,GAAG,GAAG,QAAQ,CAAC,GAAG,GAAG,MAAM,CAAC,OAAO,GAAG,EAAE,GAAG,KAAI;EACtE,IAAI,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,IAAI,GAAG,QAAQ,CAAC,IAAI,GAAG,IAAI,CAAC,WAAW,CAAC,WAAW,GAAG,CAAC,GAAG,CAAC,GAAG,KAAI;EACvF,GAAG;AACH;EACA,EAAE,IAAI,CAAC,CAAC,EAAE;EACV,IAAI,CAAC,CAAC,cAAc,GAAE;EACtB,IAAI,CAAC,CAAC,eAAe,GAAE;EACvB,IAAI,IAAI,CAAC,WAAW,CAAC,SAAS,GAAG,IAAI,CAAC,iBAAgB;EACtD,IAAI,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC,OAAO,CAAC,GAAG,IAAI;EAClD,MAAM,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,GAAG,CAAC,GAAG,IAAI,CAAC,YAAY,CAAC,GAAG,EAAC;EAC1D,KAAK,EAAC;EACN,IAAI,MAAM,CAAC,eAAe,CAAC,GAAG,IAAI,CAAC,eAAc;EACjD,IAAI,IAAI,CAAC,IAAI,CAAC,eAAe,CAAC,eAAe,CAAC,EAAE;EAChD,MAAM,IAAI,CAAC,eAAe,CAAC,eAAe,CAAC,GAAG,CAAC,IAAI,CAAC,cAAc,EAAC;EACnE,KAAK,MAAM;EACX,MAAM,IAAI,CAAC,eAAe,CAAC,eAAe,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,cAAc,EAAC;EACrE,KAAK;EACL,IAAI,MAAM,YAAY,GAAG,IAAI,CAAC,WAAW,CAAC,eAAe,EAAC;EAC1D,IAAI,IAAI,CAAC,eAAe,CAAC,eAAe,CAAC,GAAG,aAAY;EACxD,IAAI,IAAI,CAAC,YAAY,CAAC,eAAe,GAAE;EACvC,IAAI,IAAI,CAAC,WAAW,GAAG,KAAI;EAC3B,IAAI,IAAI,CAAC,IAAI,GAAE;AACf;EACA,GAAG;AACH;EACA,EAAE,WAAW,CAAC,eAAe,EAAE;EAC/B,IAAI,MAAM,GAAG,GAAG,QAAQ,CAAC,sBAAsB,CAAC,eAAe,CAAC,CAAC,CAAC,EAAC;EACnE,IAAI,MAAM,YAAY,GAAG,GAAE;EAC3B,IAAI,IAAI,aAAa,GAAG,EAAC;EACzB,IAAI,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,GAAG,CAAC,UAAU,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;EACpD,MAAM,MAAM,IAAI,GAAG,GAAG,CAAC,UAAU,CAAC,CAAC,EAAC;EACpC,MAAM,IAAI,IAAI,CAAC,QAAQ,KAAK,OAAO,EAAE;EACrC,QAAQ,aAAa,GAAG,IAAI,CAAC,WAAW,CAAC,OAAM;EAC/C,OAAO;EACP;EACA;EACA,MAAM,MAAM,UAAU,GAAG,CAAC,GAAG,EAAC;EAC9B,MAAM,IAAI,CAAC,eAAe,CAAC,eAAe,CAAC,CAAC,OAAO,CAAC,MAAM,IAAI;EAC9D,QAAQ,IAAI,GAAG,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,EAAE,IAAI,MAAM,CAAC,EAAE,EAAE;EAC/C,UAAU,YAAY,CAAC,IAAI,CAAC,IAAI,MAAM,CAAC,MAAM,CAAC,EAAE,EAAE,EAAE,EAAE,UAAU,EAAE,aAAa,EAAE,aAAa,GAAG,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,EAAC;EAC1H,SAAS;EACT,OAAO,EAAC;EACR,KAAK;EACL,IAAI,OAAO,YAAY;EACvB,GAAG;AACH;EACA,EAAE,IAAI,GAAG;EACT,IAAI,MAAM,WAAW,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,eAAe,EAAC;EAC5D,IAAI,MAAM,SAAS,GAAG,YAAY,GAAE;EACpC,IAAI,IAAI,CAAC,IAAI,GAAE;AAQf;EACA,IAAI,IAAI,IAAI,CAAC,MAAM,EAAE;EACrB,MAAM,IAAI,CAAC,MAAM,CAAC,WAAW,EAAC;EAC9B,KAAK;AACL;EACA,IAAI,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,eAAe,EAAC;EACrC,GAAG;AACH;EACA,EAAE,GAAG,GAAG;EACR,IAAI,IAAI,CAAC,WAAW,GAAG,KAAI;EAC3B,IAAI,MAAM,GAAG,GAAG,QAAQ,CAAC,cAAc,CAAC,IAAI,CAAC,QAAQ,EAAC;EACtD,IAAI,MAAM,SAAS,GAAG,GAAG,CAAC,UAAU,CAAC,SAAS,CAAC,KAAK,CAAC,GAAG,EAAC;EACzD,IAAI,MAAM,eAAe,GAAG,SAAS,CAAC,SAAS,CAAC,MAAM,GAAG,CAAC,EAAC;EAC3D,IAAI,aAAa,CAAC,GAAG,EAAC;EACtB,IAAI,MAAM,YAAY,GAAG,IAAI,CAAC,WAAW,CAAC,eAAe,EAAC;EAC1D,IAAI,IAAI,CAAC,eAAe,CAAC,eAAe,CAAC,GAAG,aAAY;EACxD,IAAI,IAAI,CAAC,IAAI,GAAE;EACf,GAAG;AACH;EACA,EAAE,iBAAiB,GAAG;EACtB,IAAI,MAAM,cAAc,GAAG,IAAI,CAAC,gBAAe;EAC/C,IAAI,MAAM,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC,OAAO,CAAC,SAAS,IAAI;EACrD,MAAM,MAAM,GAAG,GAAG,QAAQ,CAAC,sBAAsB,CAAC,SAAS,CAAC,CAAC,CAAC,EAAC;EAC/D,MAAM,cAAc,CAAC,SAAS,CAAC,CAAC,OAAO,CAAC,MAAM,IAAI;EAClD,QAAQ,MAAM,WAAW,GAAG,GAAG,CAAC,UAAU,CAAC,MAAM,CAAC,UAAU,EAAC;EAC7D,QAAQ,WAAW,CAAC,SAAS,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;EAC5C,QAAQ,MAAM,QAAQ,GAAG,WAAW,CAAC,WAAW,CAAC;EACjD,QAAQ,QAAQ,CAAC,SAAS,CAAC,MAAM,CAAC,GAAG,GAAG,MAAM,CAAC,KAAK,EAAC;EACrD,QAAQ,MAAM,UAAU,GAAG,eAAe,CAAC,IAAI,CAAC,gBAAgB,EAAE,QAAQ,CAAC,WAAW,EAAE,MAAM,CAAC,EAAE,EAAE,IAAI,CAAC,YAAY,EAAC;EACrH,QAAQ,GAAG,CAAC,YAAY,CAAC,UAAU,EAAE,QAAQ,EAAC;EAC9C,OAAO,EAAC;EACR,KAAK,EAAC;EACN,GAAG;EACH,CAAC;AACD;EACA,MAAM,CAAC,aAAa,GAAG;;;;"}