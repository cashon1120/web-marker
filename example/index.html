<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>web-marker</title>
</head>

<body>
  <h1>这是一个大大的标题</h1>
  <div>
    导致疫情二次暴发。美国国会预算办公室1日发布的数据显示，即使所有救助资金都得以用来缓解新冠疫情影响，疫情未来10年仍可能导致美国经济损失7.9万亿美元。意大利累计确诊233515例大型示威活动引发对疫情复燃的担忧根据意大利民事保护部门公布的数据，截至当地时间6月2日18时，意大利新增新冠肺炎确诊病例318例，累计确诊233515例，新增死亡病例55例，累计死亡33530例
    <p>
      9万亿美元。意大利累计确诊233515例大型示威活动引发对疫情复燃的担忧根据意大利民事保护部门公布的数据，截至当地时间6月2日18时，意大利新增新冠肺炎确诊病例318例，累计确诊233515例，新增死亡病例55例，累计死亡33530例
    </p>
  </div>
  <div>
    由白人警察暴力执法致一名非洲裔男子死亡一事引发的蔓延美国全境的抗议示威和骚乱不断升级，仍未见缓解迹象。
    9万亿美元。意大利累计确诊233515例大型示威活动引发对疫情复燃的担忧根据意大利民事保护部门公布的数据，截至当地时间6月2日18时，意大利新增新冠肺炎确诊病例318例，累计确诊233515例，新增死亡病例55例，累计死亡33530例
    <div>这里有点深

      <p>这里还要深些这里还

        <span>这里最深</span>
        要深些</p>
    </div>
  </div>
  </div>
  <div id="centercontent">
    <div id="post_detail">
      <div class="post">
        <h1 class="postTitle">
          <a id="cb_post_title_url" class="postTitle2" href="https://www.cnblogs.com/wangyihong/p/11496160.html">微信小程序
            保存图片</a>
        </h1>

        <div id="cnblogs_post_body" class="blogpost-body ">
          <h1 style="text-align: center;">微信小程序 保存图片</h1>
          <p><span style="color: #ff0000;">注： 此处使用的是小程序 wepy框架， 原生或其他的请注意转换写法</span></p>
          <div class="cnblogs_code">
            <pre>&lt;div <span style="color: #0000ff;">class</span>=<span style="color: #800000;">"</span><span style="color: #800000;">handle</span><span style="color: #800000;">"</span>&gt;
              &lt;button <span style="color: #0000ff;">class</span>=<span style="color: #800000;">"</span><span style="color: #800000;">btn</span><span style="color: #800000;">"</span> open-type=<span style="color: #800000;">"</span><span style="color: #800000;">{{saveset}}</span><span style="color: #800000;">"</span> @tap=<span style="color: #800000;">"</span><span style="color: #800000;">bindSave</span><span style="color: #800000;">"</span>&gt;
                  &lt;img src=<span style="color: #800000;">"</span><span style="color: #800000;">@/images/icon_download_white.png</span><span style="color: #800000;">"</span> alt=<span style="color: #800000;">""</span> mode=<span style="color: #800000;">"</span><span style="color: #800000;">widthFix</span><span style="color: #800000;">"</span> /&gt;<span style="color: #000000;">保存二维码
              </span>&lt;/button&gt;
              &lt;button <span style="color: #0000ff;">class</span>=<span style="color: #800000;">"</span><span style="color: #800000;">btn</span><span style="color: #800000;">"</span> open-type=<span style="color: #800000;">"</span><span style="color: #800000;">share</span><span style="color: #800000;">"</span>&gt;&lt;img src=<span style="color: #800000;">"</span><span style="color: #800000;">@/images/icon_share_white.png</span><span style="color: #800000;">"</span> alt=<span style="color: #800000;">""</span> mode=<span style="color: #800000;">"</span><span style="color: #800000;">widthFix</span><span style="color: #800000;">"</span> /&gt;分享给好友&lt;/button&gt;
  &lt;/div&gt;</pre>
          </div>
          <div class="cnblogs_code">
            <div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);"
                  onclick="copyCnblogsCode(this)" title="复制代码"><img src="//common.cnblogs.com/images/copycode.gif"
                    alt="复制代码"></a></span></div>
            <pre><span style="color: #008000;">//</span><span style="color: #008000;"> 保存图片</span>
  <span style="color: #000000;">            bindSave(e) {
                  console.log(e)
                  let that </span>= <span style="color: #0000ff;">this</span><span style="color: #000000;">;
                  wx.getSetting({</span><span style="color: #008000;">//</span><span style="color: #008000;">检查小程序的授权状态</span>
  <span style="color: #000000;">                    success(res) {
                          console.log(res)</span><span style="color: #008000;">//</span><span style="color: #008000;">授权后的回调</span>
                          <span style="color: #0000ff;">if</span> (!res.authSetting[<span style="color: #800000;">'</span><span style="color: #800000;">scope.writePhotosAlbum</span><span style="color: #800000;">'</span><span style="color: #000000;">]) {
                              wx.authorize({</span><span style="color: #008000;">//</span><span style="color: #008000;">调用 wx.authorize 弹出对话窗提醒用户是否要授权小程序得到他的授权</span>
                                  scope: <span style="color: #800000;">'</span><span style="color: #800000;">scope.writePhotosAlbum</span><span style="color: #800000;">'</span><span style="color: #000000;">,
                                  success(t) {</span><span style="color: #008000;">//</span><span style="color: #008000;">这里是用户同意授权后的回调</span>
                                      console.log(<span style="color: #800000;">"</span><span style="color: #800000;">这里是用户同意授权后的回调</span><span style="color: #800000;">"</span><span style="color: #000000;">, t)
                                      that.saveset </span>= <span style="color: #800000;">""</span><span style="color: #000000;">;
                                      that.getImage();
                                  },
                                  fail(err) {</span><span style="color: #008000;">//</span><span style="color: #008000;">这里是用户拒绝授权后的回调</span>
                                      console.log(<span style="color: #800000;">"</span><span style="color: #800000;">这里是用户拒绝授权后的回调</span><span style="color: #800000;">"</span><span style="color: #000000;">, err);
                                      that.saveset </span>= <span style="color: #800000;">"</span><span style="color: #800000;">openSetting</span><span style="color: #800000;">"</span><span style="color: #000000;">;
                                      </span><span style="color: #0000ff;">if</span> (err.errMsg == <span style="color: #800000;">"</span><span style="color: #800000;">authorize:fail:auth deny</span><span style="color: #800000;">"</span>) {<span style="color: #008000;">//</span><span style="color: #008000;">如果用户拒绝打开授权接口，通过button按钮的open-type="openSetting"属性来调起授权窗口</span>
                                          console.log(<span style="color: #800000;">"</span><span style="color: #800000;">打开设置窗口</span><span style="color: #800000;">"</span><span style="color: #000000;">);
                                          </span><span style="color: #0000ff;">if</span> (that.data.saveset == <span style="color: #800000;">"</span><span style="color: #800000;">openSetting</span><span style="color: #800000;">"</span><span style="color: #000000;">){
                                              console.log(</span><span style="color: #800000;">"</span><span style="color: #800000;">第二次进来</span><span style="color: #800000;">"</span><span style="color: #000000;">,that.data.opensett);
                                              wx.openSetting({
                                                  success(settingdata) {
                                                      console.log(settingdata)
                                                      </span><span style="color: #0000ff;">if</span> (settingdata.authSetting[<span style="color: #800000;">"</span><span style="color: #800000;">scope.writePhotosAlbum</span><span style="color: #800000;">"</span><span style="color: #000000;">]) {
                                                          console.log(</span><span style="color: #800000;">"</span><span style="color: #800000;">获取权限成功，再次点击图片保存到相册</span><span style="color: #800000;">"</span><span style="color: #000000;">)
                                                          that.setData({
                                                              saveset: </span><span style="color: #800000;">""</span><span style="color: #000000;">
                                                          });
                                                      } </span><span style="color: #0000ff;">else</span><span style="color: #000000;"> {
                                                          console.log(</span><span style="color: #800000;">"</span><span style="color: #800000;">获取权限失败</span><span style="color: #800000;">"</span><span style="color: #000000;">)
                                                      }
                                                  }
                                              });
                                          }
                                      }
                                  }
                              })
                          } </span><span style="color: #0000ff;">else</span> {<span style="color: #008000;">//</span><span style="color: #008000;">用户已经授权过了</span>
                              console.log(<span style="color: #800000;">"</span><span style="color: #800000;">用户已经授权过了</span><span style="color: #800000;">"</span><span style="color: #000000;">)
                              that.saveset </span>= <span style="color: #800000;">""</span><span style="color: #000000;">;
                              that.getImage();
                          }
                      }
                  })
              },
              getImage(){
                  wx.downloadFile({
                      url: </span><span style="color: #800000;">'</span><span style="color: #800000;">https://xcx.rejoint.com.cn/uploads/avatar/201908/29/BwCOi6fRPzsD6ZX5LstG7FPdwqHC9u8UOH90UCew.png</span><span style="color: #800000;">'</span><span style="color: #000000;">, //测试图片
                      success: function (res) {
                          console.log(res);
                          </span><span style="color: #008000;">//</span><span style="color: #008000;">图片保存到本地</span>
  <span style="color: #000000;">                        wx.saveImageToPhotosAlbum({
                              filePath: res.tempFilePath,
                              success: function (data) {
                                  console.log(</span><span style="color: #800000;">"</span><span style="color: #800000;">保存到相册</span><span style="color: #800000;">"</span><span style="color: #000000;">, data);
                                  wx.showToast({
                                    title: </span><span style="color: #800000;">'</span><span style="color: #800000;">保存成功</span><span style="color: #800000;">'</span><span style="color: #000000;">,
                                    icon: </span><span style="color: #800000;">"</span><span style="color: #800000;">none</span><span style="color: #800000;">"</span><span style="color: #000000;">
                                  })
                                },
                              fail: function (err) {
                                  console.log(err)
                              }
                          })
                      }
                  })
              }</span></pre>
            <div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);"
                  onclick="copyCnblogsCode(this)" title="复制代码"><img src="//common.cnblogs.com/images/copycode.gif"
                    alt="复制代码"></a></span></div>
          </div>
          <p>&nbsp;</p>
        </div>
        <div id="MySignature"></div>
        <div class="clear"></div>
        <div id="blog_post_info_block">


          <div id="blog_post_info">
            <div id="green_channel">
              <a href="javascript:void(0);" id="green_channel_digg"
                onclick="DiggIt(11496160,cb_blogId,1);green_channel_success(this,'谢谢推荐！');">好文要顶</a>
              <a id="green_channel_follow" onclick="follow('15eee1b2-6fb0-e611-845c-ac853d9f53ac');"
                href="javascript:void(0);">关注我</a>
              <a id="green_channel_favorite" onclick="AddToWz(cb_entryId);return false;"
                href="javascript:void(0);">收藏该文</a>
              <a id="green_channel_weibo" href="javascript:void(0);" title="分享至新浪微博" onclick="ShareToTsina()"><img
                  src="https://common.cnblogs.com/images/icon_weibo_24.png" alt=""></a>
              <a id="green_channel_wechat" href="javascript:void(0);" title="分享至微信" onclick="shareOnWechat()"><img
                  src="https://common.cnblogs.com/images/wechat.png" alt=""></a>
            </div>
            <div id="author_profile">
              <div id="author_profile_info" class="author_profile_info">
                <a href="https://home.cnblogs.com/u/wangyihong/" target="_blank"><img
                    src="https://pic.cnblogs.com/face/1067888/20170713162502.png" class="author_avatar" alt=""></a>
                <div id="author_profile_detail" class="author_profile_info">
                  <a href="https://home.cnblogs.com/u/wangyihong/">梦幻飞雪</a><br>
                  <a href="https://home.cnblogs.com/u/wangyihong/followees/">关注 - 6</a><br>
                  <a href="https://home.cnblogs.com/u/wangyihong/followers/">粉丝 - 15</a>
                </div>
              </div>
              <div class="clear"></div>
              <div id="author_profile_honor"></div>
              <div id="author_profile_follow">
                <a href="javascript:void(0);"
                  onclick="follow('15eee1b2-6fb0-e611-845c-ac853d9f53ac');return false;">+加关注</a>
              </div>
            </div>
            <div id="div_digg">
              <div class="diggit" onclick="votePost(11496160,'Digg')">
                <span class="diggnum" id="digg_count">1</span>
              </div>
              <div class="buryit" onclick="votePost(11496160,'Bury')">
                <span class="burynum" id="bury_count">0</span>
              </div>
              <div class="clear"></div>
              <div class="diggword" id="digg_tips">
              </div>
            </div>

            <script type="text/javascript">
              currentDiggType = 0;
            </script>
          </div>
          <div class="clear"></div>
          <div id="post_next_prev">

            <a href="https://www.cnblogs.com/wangyihong/p/10519258.html" class="p_n_p_prefix">« </a> 上一篇： <a
              href="https://www.cnblogs.com/wangyihong/p/10519258.html"
              title="发布于 2019-03-12 19:59">H5手机移动端调起浏览器（qq浏览器，uc浏览器）自带分享功能实例</a>
            <br>
            <a href="https://www.cnblogs.com/wangyihong/p/11511257.html" class="p_n_p_prefix">» </a> 下一篇： <a
              href="https://www.cnblogs.com/wangyihong/p/11511257.html"
              title="发布于 2019-09-12 12:22">VueJS中学习使用Vuex详解</a>

          </div>
        </div>
        <div class="postDesc">posted on
          <span id="post-date">2019-09-10 10:50</span>&nbsp;
          <a href="https://www.cnblogs.com/wangyihong/">梦幻飞雪</a>&nbsp;
          阅读(<span id="post_view_count">189</span>)&nbsp;
          评论(<span id="post_comment_count">0</span>)&nbsp;
          <a href="https://i.cnblogs.com/EditPosts.aspx?postid=11496160" rel="nofollow">编辑</a>&nbsp;
          <a href="javascript:void(0)" onclick="AddToWz(11496160);return false;">收藏</a></div>
      </div>
      <div id="comment_form" class="commentform">
        <a name="commentform"></a>
        <div id="divCommentShow"></div>
        <div id="comment_nav"><span id="span_refresh_tips"></span><a href="javascript:void(0);"
            onclick="return RefreshCommentList();" id="lnk_RefreshComments" runat="server"
            clientidmode="Static">刷新评论</a><a href="#" onclick="return RefreshPage();">刷新页面</a><a href="#top">返回顶部</a>
        </div>
        <div id="comment_form_container" style="visibility: visible;">
          <div class="login_tips">
            注册用户登录后才能发表评论，请
            <a rel="nofollow" href="javascript:void(0);" class="underline" onclick="return login('commentform');">登录</a>
            或
            <a rel="nofollow" href="javascript:void(0);" class="underline" onclick="return register();">注册</a>，
            <a href="https://www.cnblogs.com/">访问</a> 网站首页。
          </div>
        </div>
        <div class="ad_text_commentbox" id="ad_text_under_commentbox"></div>
        <div id="ad_t2"><a href="https://www.wenjuan.com/s/3uIjeq0/" target="_blank"
            onclick="ga('send', 'event', 'Link', 'click', 'T2-博客园问卷调查')">【推荐】了解你才能更懂你，博客园首发问卷调查，助力社区新升级</a><br><a
            href="http://www.ucancode.com/index.htm" target="_blank"
            onclick="ga('send', 'event', 'Link', 'click', 'T2-ucancode')">【推荐】超50万行VC++源码:
            大型组态工控、电力仿真CAD与GIS源码库</a><br><a href="https://developer.aliyun.com/article/754908?utm_content=g_1000133217"
            target="_blank" onclick="ga('send', 'event', 'Link', 'click', 'T2-阿里云开发者社区')">【推荐】独家首发 |
            900页阿里文娱技术实战，8大技术栈解析技术全景</a><br></div>
        <div id="opt_under_post"></div>
        <script async="async" src="https://www.googletagservices.com/tag/js/gpt.js"></script>
        <script>
          var googletag = googletag || {};
          googletag.cmd = googletag.cmd || [];
        </script>
        <script>
          googletag.cmd.push(function () {
            googletag.defineSlot("/1090369/C1", [300, 250], "div-gpt-ad-1546353474406-0").addService(googletag
              .pubads());
            googletag.defineSlot("/1090369/C2", [468, 60], "div-gpt-ad-1539008685004-0").addService(googletag
              .pubads());
            googletag.pubads().enableSingleRequest();
            googletag.enableServices();
          });
        </script>
        <div id="cnblogs_c1" class="c_ad_block">
          <div id="div-gpt-ad-1546353474406-0" style="height:250px; width:300px;"
            data-google-query-id="CMCykfjF9OkCFVYKXAodRp0LWQ">
            <div id="google_ads_iframe_/1090369/C1_0__container__" style="border: 0pt none;"><iframe
                id="google_ads_iframe_/1090369/C1_0" title="3rd party ad content" name="google_ads_iframe_/1090369/C1_0"
                width="300" height="250" scrolling="no" marginwidth="0" marginheight="0" frameborder="0" srcdoc=""
                style="border: 0px; vertical-align: bottom;" data-google-container-id="1"
                data-load-complete="true"></iframe></div>
          </div>
        </div>
        <div id="under_post_news">
          <div class="recomm-block"><b>相关博文：</b><br>· <a title="小程序-保存图片到相册拒绝授权后，重新调用授权保存图片到相册"
              href="https://www.cnblogs.com/liuqingxia/p/8359486.html" target="_blank"
              onclick="clickRecomItmem(8359486)">小程序-保存图片到相册拒绝授权后，重新调用授权保存图片到相册</a><br>· <a title="小程序（长按二维码图片保存至手机）"
              href="https://www.cnblogs.com/Andrea-Li/p/8569228.html" target="_blank"
              onclick="clickRecomItmem(8569228)">小程序（长按二维码图片保存至手机）</a><br>· <a title="小程序截图保存到相册"
              href="https://www.cnblogs.com/laiqiangjin/p/9212597.html" target="_blank"
              onclick="clickRecomItmem(9212597)">小程序截图保存到相册</a><br>· <a title="微信小程序长按保存图片"
              href="https://www.cnblogs.com/xiao-ling-zi/p/9511041.html" target="_blank"
              onclick="clickRecomItmem(9511041)">微信小程序长按保存图片</a><br>· <a title="图片保存到数据库的小程序"
              href="https://www.cnblogs.com/tuyile006/archive/2008/01/14/1037932.html" target="_blank"
              onclick="clickRecomItmem(1037932)">图片保存到数据库的小程序</a><br>» <a target="_blank"
              href="https://recomm.cnblogs.com/blogpost/11496160">更多推荐...</a></div>
        </div>
        <div id="cnblogs_c2" class="c_ad_block">
          <div id="div-gpt-ad-1539008685004-0" style="height:60px; width:468px;"
            data-google-query-id="CMGykfjF9OkCFVYKXAodRp0LWQ">
            <div id="google_ads_iframe_/1090369/C2_0__container__" style="border: 0pt none;"><iframe
                id="google_ads_iframe_/1090369/C2_0" title="3rd party ad content" name="google_ads_iframe_/1090369/C2_0"
                width="468" height="60" scrolling="no" marginwidth="0" marginheight="0" frameborder="0" srcdoc=""
                style="border: 0px; vertical-align: bottom;" data-google-container-id="2"
                data-load-complete="true"></iframe></div>
          </div>
        </div>
        <div id="under_post_kb">
          <div class="itnews c_ad_block">
            <b>最新 IT 新闻</b>:
            <br>
            · <a href="//news.cnblogs.com/n/663762/" target="_blank">报废掉的电脑都去哪儿了？联想官方科普</a>
            <br>
            · <a href="//news.cnblogs.com/n/663761/" target="_blank">滴滴正式闯入货运，但“无限增长”的故事不好讲</a>
            <br>
            · <a href="//news.cnblogs.com/n/663760/" target="_blank">拼多多疯狂砸价：iPhone 11降至4299元 周涛一场直播卖出1.4万台</a>
            <br>
            · <a href="//news.cnblogs.com/n/663759/" target="_blank">官宣！诺基亚5310将推出：联发科芯片 蓝牙、无线FM一应俱全</a>
            <br>
            · <a href="//news.cnblogs.com/n/663758/" target="_blank">往返机场仅需90秒！特斯拉将为“无聊公司”生产12辆电动巴士</a>
            <br>
            » <a href="https://news.cnblogs.com/" title="IT 新闻" target="_blank">更多新闻...</a>
          </div>
        </div>
        <div id="HistoryToday" class="c_ad_block"></div>

      </div>
    </div>


  </div>

  <button id="btn_clearData">清除数据(刷新生效)</button>
</body>
<script src="../dist/bundle.js"></script>
<script>
  window.addEventListener('load', () => {
    const defaultMarkers = JSON.parse(localStorage.getItem('markers'))

    const myTextMarker = new window.webMarker({
      defaultMarkers,
      markedStyles: {},
      btnStyles: {},
      onSave: (markersJson) => {
        localStorage.setItem('markers', markersJson)
      }
    })

    // 测试代码
    const btn_clearData = document.getElementById('btn_clearData')
    btn_clearData.addEventListener('click', () => {
      localStorage.removeItem('markers')
    })
  })
</script>

</html>